<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine ğŸ’–</title>
<style>
body {
  margin: 0;
  font-family: 'Comic Sans MS', cursive;
  background: linear-gradient(135deg,#ffb6c1,#ffd1dc);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
}

.page { display: none; text-align: center; width: 100%; }
.show { display: flex; flex-direction: column; align-items: center; }

.qr-box { background: white; padding: 15px; border-radius: 20px; display: inline-block; margin-top: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
.count { font-size: 100px; font-weight: bold; color: white; }
canvas { background: rgba(255, 255, 255, 0.2); border-radius: 50%; margin-top: 20px; }

.card {
  background: white;
  width: 90%;
  max-width: 360px;
  padding: 20px;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0,0,0,.2);
  position: relative;
}
img { width: 130px; transition: 0.3s ease; }
h2 { color: #ff4d6d; }
button { border: none; padding: 12px 22px; margin: 10px; font-size: 16px; border-radius: 30px; cursor: pointer; }
.yes { background: #ff4d6d; color: white; z-index: 2; }
.no { background: #ccc; position: fixed; z-index: 3; }
.gifts { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
.gift { background: #ffe6ee; padding: 15px; border-radius: 15px; cursor: pointer; font-size: 14px; }
video { width: 100%; border-radius: 15px; }

/* Floating hearts */
.heart { position: fixed; bottom: -20px; font-size: 20px; animation: float 6s linear infinite; z-index: 1; }
@keyframes float { to { transform: translateY(-110vh); opacity: 0; } }
</style>
</head>

<body>

<div id="p1" class="page">
    <h2 style="color: white;">Scan for Surprise â¤ï¸</h2>
    <div class="qr-box">
        <img id="qrImg" src="" style="width:200px;">
    </div>
    <br>
    <button class="yes" onclick="startSurprise()">Open ğŸ’Œ</button>
</div>

<div id="p2" class="page">
    <div id="count" class="count">3</div>
</div>

<div id="p3" class="page">
    <h2 style="color: white;">Drawing your surprise...</h2>
    <canvas id="heart" width="300" height="300"></canvas>
</div>

<div id="p4" class="page">
  <div class="card" id="app">
    <img src="img1.jpg" id="teddy">
    <h2 id="text">Will you be my Valentine? ğŸ’–</h2>
    <div style="margin-top:20px;">
        <button class="yes" onclick="yesClick()">Yes ğŸ’•</button>
        <button class="no" id="no" onclick="noClick()">No ğŸ’”</button>
    </div>
  </div>
</div>

<script>
const qs = new URLSearchParams(location.search);
const pages = ["p1","p2","p3","p4"].map(id=>document.getElementById(id));

// QR Code
const currentURL = window.location.href.split('?')[0];
document.getElementById('qrImg').src = "https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=" + encodeURIComponent(currentURL + "?start=1");

function show(n){
    pages.forEach(p=>p.classList.remove("show"));
    pages[n].classList.add("show");
}

function startSurprise() {
    show(1);
    let c = 3;
    const cd = setInterval(() => {
        document.getElementById("count").innerText = c;
        c--;
        if(c < 0) {
            clearInterval(cd);
            show(2);
            drawHeart();
        }
    }, 1000);
}

function drawHeart(){
    const c = document.getElementById("heart");
    const ctx = c.getContext("2d");
    ctx.strokeStyle = "white";
    ctx.lineWidth = 4;
    let t = 0;
    ctx.beginPath();
    const interval = setInterval(() => {
        let x = 150 + 16*Math.pow(Math.sin(t),3)*8;
        let y = 140 - (13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))*8;
        if(t===0) ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
        ctx.stroke();
        t += 0.05;
        if(t > Math.PI*2){
            clearInterval(interval);
            setTimeout(() => show(3), 1500); 
        }
    }, 30);
}

// --- No button logic ---
const steps = ["Think again ğŸ˜", "Are you really sure? ğŸ¥º", "Come onâ€¦ ğŸ§¸", "Last chance ğŸ˜­ğŸ’–"];
let noCount = 0;
let clicked = false;
const noBtn = document.getElementById("no");
const teddy = document.getElementById("teddy");

function moveNo(){
  const x = Math.random() * (window.innerWidth - 120);
  const y = Math.random() * (window.innerHeight - 60);
  noBtn.style.left = x + "px";
  noBtn.style.top  = y + "px";
}

function noClick(){
  if(noCount < steps.length){
    document.getElementById("text").innerText = steps[noCount];
    if(noCount === 0) teddy.src = "think.jpg";
    else if(noCount === 1) teddy.src = "sad.jpg";
    else if(noCount === 2) teddy.src = "angry.jpg";
    else if(noCount === 3) teddy.src = "sad.jpg";
    moveNo();
    noCount++;
  } else {
    moveNo();
  }
}

function yesClick(){
  if(clicked) return;
  clicked = true;
  showGifts();
}

function showGifts(){
  document.getElementById("app").innerHTML = `
    <img src="l.jpg">
    <h2>I knew it ğŸ˜</h2>
    <p>Choose your gift ğŸ</p>
    <div class="gifts">
      <div class="gift" onclick="gift1()">ğŸ¬ Gift 1</div>
      <div class="gift" onclick="gift2()">ğŸ’Œ Gift 2</div>
      <div class="gift" onclick="gift3()">â¤ï¸ Gift 3</div>
    </div>
  `;
}

function gift1(){
  document.getElementById("app").innerHTML = `
    <img src="l1.jpg">
    <h2>I knew youâ€™d say YES ğŸ’–</h2>
    <video src="video.mp4" autoplay controls muted></video>
    <br><button class="yes" onclick="showGifts()">Back ğŸ</button>
  `;
}

function gift2(){
  document.getElementById("app").innerHTML = `
    <img src="l2.jpg">
    <h2>Message ğŸ’Œ</h2>
    <p>You make my world brighter every single day ğŸ¥°</p>
    <button class="yes" onclick="showGifts()">Back ğŸ</button>
  `;
}

function gift3(){
  document.getElementById("app").innerHTML = `
    <img src="l3.jpg">
    <h2>I Love You So Much â¤ï¸</h2>
    <p>Forever & Always ğŸ’</p>
    <button class="yes" onclick="showGifts()">Back ğŸ</button>
  `;
}

// Floating Hearts
setInterval(() => {
  const h = document.createElement("div");
  h.className = "heart";
  h.innerHTML = "ğŸ’—";
  h.style.left = Math.random() * 100 + "vw";
  document.body.appendChild(h);
  setTimeout(() => h.remove(), 6000);
}, 500);

// Auto-start
if(qs.get("start") === "1") startSurprise();
else show(0);
</script>
</body>
</html>